<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="EasyKit" Language="1033" Version="1.2.6" Manufacturer="LoveDoLove" UpgradeCode="b7e2e2e2-1c2b-4e3a-9f1a-2c3d4e5f6a7b">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="EasyKit" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="EasyKit">
          <!-- Main application files -->
          <Component Id="RunEsKitBat" Guid="*">
            <File Source="$(var.ProjectDir)run_eskit.bat" KeyPath="yes" />
          </Component>
          <Component Id="ConfigFolder" Guid="*">
            <File Source="$(var.ProjectDir)config\config_eskit.bat" KeyPath="yes" />
          </Component>
          <Component Id="ScriptsFolder" Guid="272bdbeb-e87f-4dad-8dcc-67ccfa365ffd">
            <File Source="$(var.ProjectDir)scripts\core\common_eskit.bat" KeyPath="yes" />
            <File Source="$(var.ProjectDir)scripts\core\update_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\core\check_software_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\core\create_shortcuts_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\core\install_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\tools\npm_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\tools\laravel_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\tools\composer_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\tools\git_eskit.bat" />
            <File Source="$(var.ProjectDir)scripts\build\release_v1.2.6.bat" />
          </Component>
          <Component Id="ImagesFolder" Guid="dbe038a8-083d-4843-b236-88dabec74fdb">
            <File Source="$(var.ProjectDir)images\icon.ico" KeyPath="yes" />
            <File Source="$(var.ProjectDir)images\icon.jpg" />
            <File Source="$(var.ProjectDir)images\installer-header.bmp" />
            <File Source="$(var.ProjectDir)images\installer-welcome.bmp" />
          </Component>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="EasyKit"/>
      </Directory>
    </Directory>

    <ComponentGroup Id="ProductComponents">
      <ComponentRef Id="RunEsKitBat" />
      <ComponentRef Id="ConfigFolder" />
      <ComponentRef Id="ScriptsFolder" />
      <ComponentRef Id="ImagesFolder" />
    </ComponentGroup>

    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="*">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="EasyKit"
                  Description="EasyKit Application"
                  Target="[INSTALLFOLDER]run_eskit.bat"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon.ico"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\LoveDoLove\EasyKit" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <Icon Id="AppIcon.ico" SourceFile="$(var.ProjectDir)images\icon.ico" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <UIRef Id="WixUI_InstallDir" />

  </Product>
</Wix>
